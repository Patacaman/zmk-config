/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/ext_power.h>
// #include <dt-bindings/zmk/outputs.h>

// Layer Definitions
#define CANARIA 0
#define NUMNAV 1
#define SYM 2
#define TILDE 3

// Behavior configuration
&mt {
    tapping-term-ms = <200>;
    quick_tap_ms = <0>;
    flavor = "tap-preferred";
};
&lt {
    tapping-term-ms = <200>;
    quick_tap_ms = <0>;
    flavor = "tap-preferred";
};
&sk {
    release-after-ms = <500>;
    quick-release;
};


#define MACRO(name, keys)                 \
name: name##_m {                      \
    label          = #name;               \
    compatible     = "zmk,behavior-macro";\
    tap-ms         = <1>;                 \
    wait-ms        = <1>;                 \
    #binding-cells = <0>;                 \
    bindings       = <keys>;              \
};

/ {
    macros {
        MACRO(acc_a, &kp SQT &kp &a) //funcionará? y con tildes mayusculas?
        MACRO(acc_e, &kp SQT &kp &e) 
        MACRO(acc_i, &kp SQT &kp &i)
        MACRO(acc_o, &kp SQT &kp &o)
        MACRO(acc_u, &kp SQT &kp &u)
		MACRO(acc_uu, &kp LS(SQT) &kp u)
    };
};


/ {
        keymap {
                compatible = "zmk,keymap";

                canaria {			
// ----------------------------------------------------------------------------------
// | TAB  |  W  |  L  |  Y  |  P  |  B  |     |  F  |  J   |  O   |  U  |  :  | ESC |
// | CTRL |  C  |  R  |  S  |  T  |  G  |     |  M  |  N   |  E   |  I  |  A  | DEL |
// | ALT  |  Q  |  Z  |  V  |  D  |  K  |     |  X  |  H   |  /   |  ,  |  .  | GUI |
//             | NUMNAV | TIL | SFT/SPC |     | SFT/ENT | BKSP | NAV |

                        bindings = <
   &kp TAB   &kp W &kp L &kp Y &kp P &kp B   &kp F &kp J  &kp O    &kp U     &kp SQT   &kp ESC
   &kp LCTRL &kp C &kp R &kp S &kp T &kp G   &kp M &kp N  &kp E    &kp I     &kp A     &kp DEL
   &kp LALT  &kp Q &kp Z &kp V &kp D &kp K   &kp X &kp H  &kp FSLH &kp COMMA &kp DOT   &kp LGUI
        &mo NUMNAV &mo TIL &mt LSHFT SPACE   &mt RSHFT ENTER &BSPC &mo SYM
                        >;
                };
				
				number_navigation {
// ----------------------------------------------------------------------------------------
// | TAB  | HOME | LWORD | RWORD | END   | PGUP |     |  /  |  7  |  8  |  9  |  -  |  ,  |
// | CTRL | LEFT | UP    | DOWN  | RIGHT | PGDN |     |  *  |  4  |  5  |  6  |  +  | DEL |
// | ALT  | UNDO | CUT   | COPY  | PASTE | REDO |     |  0  |  1  |  2  |  3  |  =  |  .  |

                        bindings = <
	&trans	&HOME	  &kp LC(LEFT) &kp LC(RIGHT) &END	   &kp PG_UP	&SLASH	&N7	&N6	&N9	&MINUS	&COMMA
	&trans	&kp LEFT  &kp DOWN     &kp UP 		 &kp RIGHT &kp PG_DN 	&AMPS	&N4	&N5	&N6	&PLUS	&trans	
	&trans	&kp LC(Z) &kp LC(X)	   &kp LC(C)	 &kp LC(V) &kp LC(Y)	&N0		&N1	&N2	&N3	&EQUAL	&DOT
                                              &trans &trans   &trans    &trans   &trans    &trans
                        >;
                };
				
                symbols {

// ------------------------------------------------------------------------------
// | TAB  |     |  "  |  #  |  (  |  €  |   |  /  |  7  |  8  |  9  |  -  |  ,  |
// | CTRL |  |  |  !  |  ?  |  [  |  &  |   |  *  |  4  |  5  |  6  |  +  | DEL |
// | ALT  |     |     |  <  |  {  |  $  |   |  0  |  1  |  2  |  3  |  =  |  .  |

                        bindings = <
   &trans	&none	&none	&none	&none	&none		&none	&none	&none	&none	&none	&trans	
   &trans	&none	&none	&none	&none	&none		&none	&none	&none	&none	&none	&trans	
   &trans	&none	&none	&none	&none	&none		&none	&none	&none	&none	&none	&trans	   
							&trans 	&trans	&trans		&trans  &trans 	&trans
                        >;
                };

				adjust_layer {			
// -----------------------------------------------------------------------------------------
// | BTCLR| BT1  | BT2 | BT3  | BT4 | VOL_UP |   | NEXT | F7 | F8 | F9 | F12 | |
// |      | CAPS |     | SNIP |     | VOL_DN |   | PREV | F4 | F5 | F6 | F11 | |
// |      |      |     |      |     | MUTE   |   | PLAY | F1 | F2 | F3 | F10 | |
//                      |     |     |        |   |      |    |    |
                        bindings = <
   &bt BT_CLR &bt BT_SEL 0	&bt BT_SEL 1 &bt BT_SEL 2 &bt BT_SEL 3	&bt BT_SEL 4 &XXXX		&XXXX	&kp F7	&kp F8	&kp F9	&kp F12	&trans	
   &trans 	  &XXXX			&none		 &XXXX		  &none		 	&XXXX		 &XXXX		&XXXX	&kp F4	&kp F5	&kp F6	&kp F11	&trans	
   &trans 	  &none			&none		 &none		  &none		 	&XXXX		 &XXXX		&XXXX	&kp F1	&kp F2	&kp F3	&kp F10	&trans	   
													  &trans 		&trans 		 &trans		&trans  &trans 	&trans
                        >;
                };
				
				tilde {			
// -----------------------------------------------------------------------------------------
// |   |   |  |  |  |  |   |  |   | Ó | Ú | Ü |   |
// |   | Ç |  |  |  |  |   |  | Ñ | É | Í | Á |   |
// |   |   |  |  |  |  |   |  |   |   |   |   |   |
//            |  |  |  |   |  |   |   |
                        bindings = <
   &none &none &none &none &none &none   &none &none    &acc_o_m &acc_u_m &acc_uu_m &none
   &none &BSLH &none &none &none &none   &none &kp SEMI &acc_e_m &acc_i_m &acc_a_m  &none
   &none &none &none &none &none &none   &none &none    &none    &none    &none     &none
                     &none &none &none   &none &none    &none
                        >;
                };
 
        };
};